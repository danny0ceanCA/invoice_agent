{"id":"0001","question":"Show monthly spend for Addison Johnson.","sql_used":"SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices WHERE district_key = :district_key AND LOWER(student_name) = LOWER('addison johnson') GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0002","question":"Show monthly hours for Addison Johnson.","sql_used":"SELECT LOWER(i.service_month) AS service_month, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.student) = LOWER('addison johnson') GROUP BY LOWER(i.service_month) ORDER BY MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0003","question":"Show year-to-date spend for Addison Perez.","sql_used":"SELECT invoice_number, student_name, total_cost, service_month, status FROM invoices WHERE district_key = :district_key AND LOWER(student_name) = LOWER('addison perez') AND strftime('%Y', invoice_date) = strftime('%Y', 'now') ORDER BY invoice_date DESC, total_cost DESC"}
{"id":"0004","question":"Show year-to-date hours for Addison Perez.","sql_used":"SELECT invoice_number, student_name, total_hours, service_month, status FROM invoices WHERE district_key = :district_key AND LOWER(student_name) = LOWER('addison perez') AND strftime('%Y', invoice_date) = strftime('%Y', 'now') ORDER BY invoice_date DESC, total_hours DESC"}
{"id":"0005","question":"Which students have the highest total spend this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(i.student_name) AS student_name, SUM(i.total_cost) AS total_spend FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(i.student_name) ORDER BY total_spend DESC LIMIT 5"}
{"id":"0006","question":"Which students have the highest total hours this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(i.student_name) AS student_name, SUM(i.total_hours) AS total_hours FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(i.student_name) ORDER BY total_hours DESC LIMIT 5"}
{"id":"0009","question":"Which students started receiving services this school year?","sql_used":"WITH student_first_invoice AS (SELECT LOWER(i.student_name) AS student_name, MIN(date(i.invoice_date)) AS first_invoice_date FROM invoices i WHERE i.district_key = :district_key GROUP BY LOWER(i.student_name)), school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT s.student_name, s.first_invoice_date FROM student_first_invoice s, school_year sy WHERE s.first_invoice_date BETWEEN sy.school_year_start AND sy.school_year_end ORDER BY s.first_invoice_date, s.student_name"}
{"id":"0011","question":"Show total spend for all students by month.","sql_used":"SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices WHERE district_key = :district_key GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0013","question":"Compare Addison Johnson and Alexander Brown by monthly spend.","sql_used":"SELECT LOWER(student_name) AS student_name, LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices WHERE district_key = :district_key AND LOWER(student_name) IN ('addison johnson','alexander brown') GROUP BY LOWER(student_name), LOWER(service_month) ORDER BY LOWER(student_name), MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0014","question":"Compare Addison Johnson and Alexander Brown by monthly hours.","sql_used":"SELECT LOWER(ili.student) AS student_name, LOWER(i.service_month) AS service_month, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.student) IN ('addison johnson', 'alexander brown') GROUP BY LOWER(ili.student), LOWER(i.service_month) ORDER BY LOWER(ili.student), LOWER(i.service_month)"}
{"id":"0015","question":"Show all invoices for Alexander Jones.","sql_used":"SELECT invoice_number, student_name, total_cost, service_month, status FROM invoices WHERE district_key = :district_key AND LOWER(student_name) = LOWER('alexander jones') ORDER BY invoice_date DESC, total_cost DESC"}
{"id":"0016","question":"Show services delivered to Alexander Thomas over a date range.","sql_used":"SELECT invoice_number, student_name, total_cost, service_month, status FROM invoices WHERE district_key = :district_key AND LOWER(student_name) = LOWER('alexander thomas') ORDER BY invoice_date DESC, total_cost DESC"}
{"id":"0017","question":"Show monthly spend for Action Supportive Care.","sql_used":"SELECT LOWER(i.service_month) AS service_month, SUM(i.total_cost) AS total_cost FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = LOWER('action supportive care') GROUP BY LOWER(i.service_month) ORDER BY MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0018","question":"Show monthly hours for Action Supportive Care.","sql_used":"SELECT LOWER(i.service_month) AS service_month, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = LOWER('action supportive care') GROUP BY LOWER(i.service_month) ORDER BY MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0019","question":"Show year-to-date spend for Action Supportive Care.","sql_used":"SELECT v.name AS vendor_name, SUM(i.total_cost) AS total_spend FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = LOWER('action supportive care') AND strftime('%Y', i.invoice_date) = strftime('%Y', 'now') GROUP BY v.name"}
{"id":"0021","question":"Which vendors have the highest total hours this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS sy_start, date(strftime('%Y','now') || '-06-30','+1 year') AS sy_end) SELECT v.name AS vendor_name, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.sy_start AND sy.sy_end GROUP BY v.name ORDER BY total_hours DESC LIMIT 5"}
{"id":"0022","question":"Compare Action Supportive Care and SCUSD Accounts Payable by monthly spend.","sql_used":"SELECT LOWER(v.name) AS vendor_name, LOWER(i.service_month) AS service_month, SUM(i.total_cost) AS total_cost FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND (LOWER(v.name) = 'action supportive care' OR LOWER(v.name) = 'scusd accounts payable') GROUP BY LOWER(v.name), LOWER(i.service_month) ORDER BY LOWER(v.name), MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0023","question":"Compare Action Supportive Care and SCUSD Accounts Payable by monthly hours.","sql_used":"SELECT LOWER(i.service_month) AS service_month, v.name AS vendor_name, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND (LOWER(v.name) = 'action supportive care' OR LOWER(v.name) = 'scusd accounts payable') GROUP BY LOWER(i.service_month), v.name ORDER BY LOWER(i.service_month), v.name"}
{"id":"0024","question":"Show vendors with increasing spend over the last three months.","sql_used":"WITH monthly_vendor AS (SELECT v.name AS vendor_name, strftime('%Y-%m', i.invoice_date) AS year_month, SUM(i.total_cost) AS total_spend FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key GROUP BY v.name, strftime('%Y-%m', i.invoice_date)), ranked AS (SELECT vendor_name, year_month, total_spend, LAG(total_spend) OVER (PARTITION BY vendor_name ORDER BY year_month) AS prev_month, LAG(total_spend,2) OVER (PARTITION BY vendor_name ORDER BY year_month) AS prev_prev_month FROM monthly_vendor) SELECT vendor_name, prev_prev_month, prev_month, total_spend AS current_month FROM ranked WHERE prev_prev_month IS NOT NULL AND prev_month IS NOT NULL AND total_spend > prev_month AND prev_month > prev_prev_month ORDER BY current_month DESC"}
{"id":"0025","question":"Show vendors with decreasing spend over the last three months.","sql_used":"WITH monthly_vendor AS (SELECT v.name AS vendor_name, strftime('%Y-%m', i.invoice_date) AS year_month, SUM(i.total_cost) AS total_spend FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key GROUP BY v.name, strftime('%Y-%m', i.invoice_date)), ranked AS (SELECT vendor_name, year_month, total_spend, LAG(total_spend) OVER (PARTITION BY vendor_name ORDER BY year_month) AS prev_month, LAG(total_spend,2) OVER (PARTITION BY vendor_name ORDER BY year_month) AS prev_prev_month FROM monthly_vendor) SELECT vendor_name, prev_prev_month, prev_month, total_spend AS current_month FROM ranked WHERE prev_prev_month IS NOT NULL AND prev_month IS NOT NULL AND total_spend < prev_month AND prev_month < prev_prev_month ORDER BY current_month ASC"}
{"id":"0026","question":"Show all invoices for Action Supportive Care.","sql_used":"SELECT i.invoice_number, i.student_name, i.total_cost, i.service_month, i.status FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = 'action supportive care' ORDER BY i.invoice_date DESC, i.total_cost DESC"}
{"id":"0027","question":"Show invoice details for Action Supportive Care.","sql_used":"SELECT i.invoice_number, i.service_month, ili.service_date, ili.student, ili.clinician, ili.service_code, ili.hours, ili.cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = 'action supportive care' ORDER BY i.invoice_date DESC, i.invoice_number, ili.service_date"}
{"id":"0028","question":"Which vendors are serving the most students?","sql_used":"SELECT v.name AS vendor_name, COUNT(DISTINCT i.student_name) AS students_served FROM invoices i JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key GROUP BY v.name ORDER BY students_served DESC LIMIT 5"}
{"id":"0029","question":"Which vendors are providing the most hours?","sql_used":"SELECT v.name AS vendor_name, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key GROUP BY v.name ORDER BY total_hours DESC LIMIT 5"}
{"id":"0030","question":"Show monthly hours for clinician Addison Price.","sql_used":"SELECT LOWER(i.service_month) AS service_month, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) = 'addison price' GROUP BY LOWER(i.service_month) ORDER BY MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0031","question":"Show monthly cost for clinician Addison Price.","sql_used":"SELECT LOWER(i.service_month) AS service_month, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) = 'addison price' GROUP BY LOWER(i.service_month) ORDER BY MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0032","question":"Show year-to-date hours for clinician Aiden Jenkins.","sql_used":"SELECT ili.clinician AS clinician_name, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) = 'aiden jenkins' AND strftime('%Y', i.invoice_date) = strftime('%Y','now') GROUP BY ili.clinician"}
{"id":"0033","question":"Show year-to-date cost for clinician Aiden Jenkins.","sql_used":"SELECT ili.clinician AS clinician_name, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) = 'aiden jenkins' AND strftime('%Y', i.invoice_date) = strftime('%Y','now') GROUP BY ili.clinician"}
{"id":"0034","question":"Which clinicians have the highest total hours this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS sy_start, date(strftime('%Y','now') || '-06-30','+1 year') AS sy_end) SELECT ili.clinician, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.sy_start AND sy.sy_end GROUP BY ili.clinician ORDER BY total_hours DESC LIMIT 5"}
{"id":"0035","question":"Which clinicians have the highest total cost this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS sy_start, date(strftime('%Y','now') || '-06-30','+1 year') AS sy_end) SELECT ili.clinician, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.sy_start AND sy.sy_end GROUP BY ili.clinician ORDER BY total_cost DESC LIMIT 5"}
{"id":"0036","question":"Show hours by clinician type for this school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS sy_start, date(strftime('%Y','now') || '-06-30','+1 year') AS sy_end) SELECT ili.service_code AS clinician_type, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.sy_start AND sy.sy_end GROUP BY ili.service_code ORDER BY total_hours DESC"}
{"id":"0037","question":"Show cost by clinician type for this school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS sy_start, date(strftime('%Y','now') || '-06-30','+1 year') AS sy_end) SELECT ili.service_code AS clinician_type, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.sy_start AND sy.sy_end GROUP BY ili.service_code ORDER BY total_cost DESC"}
{"id":"0038","question":"Compare clinician types by monthly hours.","sql_used":"SELECT LOWER(i.service_month) AS service_month, ili.service_code AS clinician_type, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key GROUP BY LOWER(i.service_month), ili.service_code ORDER BY LOWER(i.service_month), total_hours DESC"}
{"id":"0039","question":"Compare clinician types by monthly cost.","sql_used":"SELECT ili.service_code AS clinician_type, LOWER(i.service_month) AS service_month, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key GROUP BY ili.service_code, LOWER(i.service_month) ORDER BY LOWER(i.service_month), ili.service_code"}
{"id":"0040","question":"Compare clinicians Amelia Sanders and Aubrey Garcia by monthly hours.","sql_used":"SELECT LOWER(i.service_month) AS service_month, LOWER(ili.clinician) AS clinician, SUM(ili.hours) AS total_hours FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) IN ('amelia sanders','aubrey garcia') GROUP BY LOWER(i.service_month), LOWER(ili.clinician) ORDER BY LOWER(ili.clinician), MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0041","question":"Compare clinicians Amelia Sanders and Aubrey Garcia by monthly cost.","sql_used":"SELECT LOWER(i.service_month) AS service_month, LOWER(ili.clinician) AS clinician, SUM(ili.cost) AS total_cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.clinician) IN ('amelia sanders','aubrey garcia') GROUP BY LOWER(i.service_month), LOWER(ili.clinician) ORDER BY LOWER(ili.clinician), MIN(strftime('%m', i.invoice_date)) ASC"}
{"id":"0045","question":"Show total district spend by month for this school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0046","question":"Show total district hours by month for this school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_hours) AS total_hours FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0047","question":"Show year-to-date district spend.","sql_used":"SELECT SUM(total_cost) AS total_spend FROM invoices WHERE district_key = :district_key AND strftime('%Y', invoice_date) = strftime('%Y','now')"}
{"id":"0048","question":"Show year-to-date district hours.","sql_used":"SELECT SUM(total_hours) AS total_hours FROM invoices WHERE district_key = :district_key AND strftime('%Y', invoice_date) = strftime('%Y','now')"}
{"id":"0049","question":"Show district spend trend over the school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0050","question":"Show district hours trend over the school year.","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_hours) AS total_hours FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0051","question":"Which month had the highest district spend this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_spend FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY total_spend DESC LIMIT 1"}
{"id":"0052","question":"Which month had the lowest district spend this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end) SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_spend FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month) ORDER BY total_spend ASC LIMIT 1"}
{"id":"0053","question":"What is the district's average monthly spend this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end), monthly_totals AS (SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month)) SELECT ROUND(AVG(total_cost),2) AS average_monthly_spend FROM monthly_totals"}
{"id":"0054","question":"What is the district's average monthly hours this school year?","sql_used":"WITH school_year AS (SELECT date(strftime('%Y','now') || '-07-01') AS school_year_start, date(strftime('%Y','now') || '-06-30','+1 year') AS school_year_end), monthly_totals AS (SELECT LOWER(service_month) AS service_month, SUM(total_hours) AS total_hours FROM invoices i, school_year sy WHERE i.district_key = :district_key AND date(i.invoice_date) BETWEEN sy.school_year_start AND sy.school_year_end GROUP BY LOWER(service_month)) SELECT ROUND(AVG(total_hours),2) AS average_monthly_hours FROM monthly_totals"}
{"id":"0055","question":"Compare district spend for July and August.","sql_used":"SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices WHERE district_key = :district_key AND LOWER(service_month) IN ('july','august') GROUP BY LOWER(service_month) ORDER BY CASE LOWER(service_month) WHEN 'july' THEN 1 ELSE 2 END"}
{"id":"0056","question":"Compare district hours for July and August.","sql_used":"SELECT LOWER(service_month) AS service_month, SUM(total_hours) AS total_hours FROM invoices WHERE district_key = :district_key AND LOWER(service_month) IN ('july','august') GROUP BY LOWER(service_month) ORDER BY CASE LOWER(service_month) WHEN 'july' THEN 1 ELSE 2 END"}
{"id":"0057","question":"Show total district spend for September.","sql_used":"SELECT SUM(total_cost) AS total_spend FROM invoices WHERE district_key = :district_key AND LOWER(service_month) = LOWER('september')"}
{"id":"0058","question":"Show total district hours for October.","sql_used":"SELECT SUM(total_hours) AS total_hours FROM invoices WHERE district_key = :district_key AND LOWER(service_month) = LOWER('october')"}
{"id":"0059","question":"Show district spend since the start of the 2025 school year.","sql_used":"SELECT LOWER(service_month) AS service_month, SUM(total_cost) AS total_cost FROM invoices WHERE district_key = :district_key AND strftime('%Y', invoice_date) = '2025' GROUP BY LOWER(service_month) ORDER BY MIN(strftime('%m', invoice_date)) ASC"}
{"id":"0060","question":"Show invoice details for {student} for {month}.","sql_used":"SELECT i.invoice_number, i.service_month, ili.service_date, ili.student, ili.clinician, ili.service_code, ili.hours, ili.cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id WHERE i.district_key = :district_key AND LOWER(ili.student) = LOWER(:student_name) AND LOWER(i.service_month) = LOWER(:service_month) ORDER BY ili.service_date ASC, i.invoice_number ASC"}
{"id":"0061","question":"Show invoice details for {student} from {vendor} for {month}.","sql_used":"SELECT i.invoice_number, i.service_month, ili.service_date, ili.student, ili.clinician, ili.service_code, ili.hours, ili.cost FROM invoice_line_items ili JOIN invoices i ON ili.invoice_id = i.id JOIN vendors v ON v.id = i.vendor_id WHERE i.district_key = :district_key AND LOWER(v.name) = LOWER(:vendor_name) AND LOWER(ili.student) = LOWER(:student_name) AND LOWER(i.service_month) = LOWER(:service_month) ORDER BY ili.service_date ASC, i.invoice_number ASC"}
